generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String                @id @default(uuid())
  email                 String                @unique
  name                  String
  image                 String?
  role                  Role                  @default(USER)
  password              String
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt
  property_applications PropertyApplication[]
}

model Landlord {
  id           String     @id @default(uuid())
  name         String
  email        String     @unique
  phone        String?
  company_name String?
  address      String?
  isVerified   Boolean    @default(false)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  properties   Property[]
}

model Property {
  id                    String                @id @default(uuid())
  title                 String
  description           String
  property_type         propertyType          @default(APARTMENT)
  status                Status                @default(FOR_RENT)
  price                 Float
  currency              Currency              @default(USD)
  payment_frequency     PaymentFrequency      @default(MONTHLY)
  deposit_amount        Float?
  country               String
  city                  String
  address               String
  zip_code              String
  latitude              Float
  longitude             Float
  bedrooms              Int?
  bathrooms             Int?
  garages               Int?
  size                  Float?
  is_furnished          Boolean?              @default(false)
  floor                 Int?
  total_floors          Int?
  balcony               Boolean?              @default(false)
  amenities             String[]
  is_featured           Boolean?              @default(false)
  landlord_id           String?
  landlord              Landlord? @relation(fields: [landlord_id], references: [id])
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt
  property_applications PropertyApplication[]
  images                PropertyImages[]
  payments              Payment[]
}

model PropertyImages {
  id         String   @id @default(cuid())
  propertyId String
  url        String
  createdAt  DateTime @default(now())
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
}

model PropertyApplication {
  id         String            @id @default(cuid())
  propertyId String
  tenantId   String
  message    String?
  status     ApplicationStatus @default(PENDING)
  createdAt  DateTime          @default(now())
  property   Property          @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  tenant     User              @relation(fields: [tenantId], references: [id])
  payments   Payment[]
}


model Payment {
  id         String            @id @default(cuid())
  applicationId String
  propertyId String
  amount Float
  status PaymentStatus @default(PENDING)
  
  paymentDate DateTime? @default(now())
  createdAt DateTime @default(now())
  application PropertyApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
  property Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
}


enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
}

enum ApplicationStatus {
  PENDING
  APPROVED
  REJECTED
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
  PROPERTY_OWNER
}

enum propertyType {
  APARTMENT
  HOUSE
  STUDIO
  OFFICE
  LAND
}

enum Status {
  FOR_SALE
  FOR_RENT
  SOLD
  RENTED
}

enum Currency {
  USD
  EUR
  GBP
  CAD
  AUD
  NZD
  CHF
  JPY
  CNY
}

enum PaymentFrequency {
  MONTHLY
  YEARLY
  WEEKLY
  DAILY
}

enum ContactMethod {
  EMAIL
  PHONE
  WHATSAPP
  TELEGRAM
  SMS
}
