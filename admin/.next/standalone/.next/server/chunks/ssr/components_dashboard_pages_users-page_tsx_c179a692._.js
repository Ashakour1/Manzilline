module.exports=[47836,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(54161),f=a.i(40695),g=a.i(3130),h=a.i(65733),i=a.i(5522),j=a.i(17171),k=a.i(87682),l=a.i(50463),m=a.i(88237),n=a.i(87271),o=a.i(15618),p=a.i(87532),q=a.i(77156),r=a.i(99464),s=a.i(81560),t=a.i(9941),u=a.i(60246),v=a.i(92258),w=a.i(3314),x=a.i(53250);let y=`${x.API_URL}/users`,z=async()=>{let a=await fetch(y,{credentials:"include"});if(!a.ok)throw Error("Failed to fetch users");return a.json()},A=async a=>{let b=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),credentials:"include"});if(!b.ok)throw Error((await b.json()).message||"Failed to create user");return b.json()},B=async(a,b)=>{let c=await fetch(`${y}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b),credentials:"include"});if(!c.ok)throw Error((await c.json()).message||"Failed to update user");return c.json()},C=async a=>{let b=await fetch(`${y}/${a}`,{method:"DELETE",credentials:"include"});if(!b.ok)throw Error((await b.json()).message||"Failed to delete user");return b.json()};var D=a.i(70246);function E(){let a=(0,d.useRouter)(),{toast:x}=(0,D.useToast)(),[y,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)("createdAt"),[T,U]=(0,c.useState)("desc"),[V,W]=(0,c.useState)(1),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)({name:"",email:"",password:"",role:"USER"});(0,c.useEffect)(()=>{ad()},[]);let ad=async()=>{G(!0),I(null);try{let a=await z();E(a||[])}catch(a){I(a instanceof Error?a.message:"Failed to load users"),x({title:"Error",description:a instanceof Error?a.message:"Failed to load users",variant:"destructive"})}finally{G(!1)}},ae=(0,c.useMemo)(()=>{let a=y.length;return{total:a,admins:y.filter(a=>"ADMIN"===a.role||"SUPER_ADMIN"===a.role).length,regularUsers:y.filter(a=>"USER"===a.role).length}},[y]),af=(0,c.useMemo)(()=>{let a=P.toLowerCase().trim(),b=y.filter(b=>{let c=b.name?.toLowerCase()??"",d=b.email?.toLowerCase()??"",e=b.role?.toLowerCase()??"";return!a||c.includes(a)||d.includes(a)||e.includes(a)});return b.sort((a,b)=>{let c,d;switch(R){case"name":c=a.name?.toLowerCase()??"",d=b.name?.toLowerCase()??"";break;case"email":c=a.email?.toLowerCase()??"",d=b.email?.toLowerCase()??"";break;case"role":c=a.role?.toLowerCase()??"",d=b.role?.toLowerCase()??"";break;case"createdAt":c=a.createdAt?new Date(a.createdAt).getTime():0,d=b.createdAt?new Date(b.createdAt).getTime():0;break;default:return 0}return c<d?"asc"===T?-1:1:c>d?"asc"===T?1:-1:0}),b},[y,P,R,T]),ag=Math.ceil(af.length/10),ah=(0,c.useMemo)(()=>{let a=(V-1)*10;return af.slice(a,a+10)},[af,V]),ai=a=>{R===a?U("asc"===T?"desc":"asc"):(S(a),U("asc"))},aj=async()=>{if(N){K(N);try{await C(N),await ad(),M(!1),O(null),x({title:"Success",description:"User deleted successfully"})}catch(a){x({title:"Error",description:a instanceof Error?a.message:"Failed to delete user",variant:"destructive"})}finally{K(null)}}},ak=async()=>{if(!ab.name||!ab.email||!ab.password)return void x({title:"Error",description:"Please fill in all required fields",variant:"destructive"});try{await A({name:ab.name,email:ab.email,password:ab.password,role:ab.role}),await ad(),Y(!1),ac({name:"",email:"",password:"",role:"USER"}),x({title:"Success",description:"User created successfully"})}catch(a){x({title:"Error",description:a instanceof Error?a.message:"Failed to create user",variant:"destructive"})}},al=async()=>{if(!_||!ab.name||!ab.email)return void x({title:"Error",description:"Please fill in all required fields",variant:"destructive"});try{await B(_.id,{name:ab.name,email:ab.email,role:ab.role,...ab.password&&{password:ab.password}}),await ad(),$(!1),aa(null),ac({name:"",email:"",password:"",role:"USER"}),x({title:"Success",description:"User updated successfully"})}catch(a){x({title:"Error",description:a instanceof Error?a.message:"Failed to update user",variant:"destructive"})}};return(0,b.jsxs)("div",{className:"space-y-6 p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Users"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage system users and permissions"})]}),(0,b.jsxs)(f.Button,{onClick:()=>Y(!0),children:[(0,b.jsx)(o.Plus,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,b.jsx)(u.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ae.total}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Registered users"})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Administrators"}),(0,b.jsx)(w.Shield,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ae.admins}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Admin users"})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Regular Users"}),(0,b.jsx)(u.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ae.regularUsers}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Standard users"})]})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Users"}),(0,b.jsx)(g.CardDescription,{children:"View and manage all system users"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"mb-4 flex gap-4",children:(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(p.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(i.Input,{placeholder:"Search by name, email, or role...",value:P,onChange:a=>Q(a.target.value),className:"pl-10"})]})}),F?(0,b.jsx)("div",{className:"space-y-2",children:Array.from({length:5}).map((a,c)=>(0,b.jsx)(l.Skeleton,{className:"h-16 w-full"},c))}):H?(0,b.jsx)("div",{className:"py-8 text-center text-sm text-destructive",children:H}):0===ah.length?(0,b.jsx)(n.Empty,{children:(0,b.jsxs)(n.EmptyHeader,{children:[(0,b.jsx)(n.EmptyTitle,{children:"No users found"}),(0,b.jsx)(n.EmptyDescription,{children:"Get started by creating a new user."})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(m.Table,{children:[(0,b.jsx)(m.TableHeader,{children:(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableHead,{children:(0,b.jsxs)("button",{className:"flex items-center gap-2 hover:text-foreground",onClick:()=>ai("name"),children:["Name",(0,b.jsx)(t.ArrowUpDown,{className:"h-3 w-3"})]})}),(0,b.jsx)(m.TableHead,{children:(0,b.jsxs)("button",{className:"flex items-center gap-2 hover:text-foreground",onClick:()=>ai("email"),children:["Email",(0,b.jsx)(t.ArrowUpDown,{className:"h-3 w-3"})]})}),(0,b.jsx)(m.TableHead,{children:(0,b.jsxs)("button",{className:"flex items-center gap-2 hover:text-foreground",onClick:()=>ai("role"),children:["Role",(0,b.jsx)(t.ArrowUpDown,{className:"h-3 w-3"})]})}),(0,b.jsx)(m.TableHead,{children:"Applications"}),(0,b.jsx)(m.TableHead,{children:(0,b.jsxs)("button",{className:"flex items-center gap-2 hover:text-foreground",onClick:()=>ai("createdAt"),children:["Created",(0,b.jsx)(t.ArrowUpDown,{className:"h-3 w-3"})]})}),(0,b.jsx)(m.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(m.TableBody,{children:ah.map(c=>(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableCell,{className:"font-medium",children:c.name}),(0,b.jsx)(m.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Mail,{className:"h-3 w-3 text-muted-foreground"}),c.email]})}),(0,b.jsx)(m.TableCell,{children:(0,b.jsx)(e.Badge,{variant:(a=>{switch(a){case"SUPER_ADMIN":return"destructive";case"ADMIN":return"default";case"PROPERTY_OWNER":return"secondary";default:return"outline"}})(c.role),children:c.role})}),(0,b.jsx)(m.TableCell,{children:(0,b.jsx)(e.Badge,{variant:"secondary",children:c._count?.property_applications||0})}),(0,b.jsx)(m.TableCell,{children:c.createdAt?new Date(c.createdAt).toLocaleDateString():"-"}),(0,b.jsx)(m.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>a.push(`/users/${c.id}`),children:(0,b.jsx)(q.Eye,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{aa(c),ac({name:c.name,email:c.email,password:"",role:c.role}),$(!0)},children:(0,b.jsx)(r.Pencil,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{O(c.id),M(!0)},children:(0,b.jsx)(s.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},c.id))})]})}),ag>1&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",(V-1)*10+1," to"," ",Math.min(10*V,af.length)," of"," ",af.length," users"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>W(a=>Math.max(1,a-1)),disabled:1===V,children:"Previous"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>W(a=>Math.min(ag,a+1)),disabled:V===ag,children:"Next"})]})]})]})]})]}),(0,b.jsx)(h.Dialog,{open:X,onOpenChange:Y,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Create New User"}),(0,b.jsx)(h.DialogDescription,{children:"Add a new user to the system"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"create-name",children:"Name"}),(0,b.jsx)(i.Input,{id:"create-name",value:ab.name,onChange:a=>ac({...ab,name:a.target.value}),placeholder:"John Doe"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"create-email",children:"Email"}),(0,b.jsx)(i.Input,{id:"create-email",type:"email",value:ab.email,onChange:a=>ac({...ab,email:a.target.value}),placeholder:"john@example.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"create-password",children:"Password"}),(0,b.jsx)(i.Input,{id:"create-password",type:"password",value:ab.password,onChange:a=>ac({...ab,password:a.target.value}),placeholder:"••••••••"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"create-role",children:"Role"}),(0,b.jsxs)(k.Select,{value:ab.role,onValueChange:a=>ac({...ab,role:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"USER",children:"User"}),(0,b.jsx)(k.SelectItem,{value:"ADMIN",children:"Admin"}),(0,b.jsx)(k.SelectItem,{value:"SUPER_ADMIN",children:"Super Admin"}),(0,b.jsx)(k.SelectItem,{value:"PROPERTY_OWNER",children:"Property Owner"})]})]})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:ak,children:"Create User"})]})]})}),(0,b.jsx)(h.Dialog,{open:Z,onOpenChange:$,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Edit User"}),(0,b.jsx)(h.DialogDescription,{children:"Update user information"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"edit-name",children:"Name"}),(0,b.jsx)(i.Input,{id:"edit-name",value:ab.name,onChange:a=>ac({...ab,name:a.target.value}),placeholder:"John Doe"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"edit-email",children:"Email"}),(0,b.jsx)(i.Input,{id:"edit-email",type:"email",value:ab.email,onChange:a=>ac({...ab,email:a.target.value}),placeholder:"john@example.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"edit-password",children:"Password (leave blank to keep current)"}),(0,b.jsx)(i.Input,{id:"edit-password",type:"password",value:ab.password,onChange:a=>ac({...ab,password:a.target.value}),placeholder:"••••••••"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{htmlFor:"edit-role",children:"Role"}),(0,b.jsxs)(k.Select,{value:ab.role,onValueChange:a=>ac({...ab,role:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"USER",children:"User"}),(0,b.jsx)(k.SelectItem,{value:"ADMIN",children:"Admin"}),(0,b.jsx)(k.SelectItem,{value:"SUPER_ADMIN",children:"Super Admin"}),(0,b.jsx)(k.SelectItem,{value:"PROPERTY_OWNER",children:"Property Owner"})]})]})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>$(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:al,children:"Update User"})]})]})}),(0,b.jsx)(h.Dialog,{open:L,onOpenChange:M,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Delete User"}),(0,b.jsxs)(h.DialogDescription,{children:["Are you sure you want to delete this user? This action cannot be undone.",N&&y.find(a=>a.id===N)?._count&&y.find(a=>a.id===N)._count.property_applications>0&&(0,b.jsx)("span",{className:"mt-2 block text-destructive",children:"Warning: This user has property applications associated with them."})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{variant:"destructive",onClick:aj,disabled:null!==J,children:J?"Deleting...":"Delete"})]})]})})]})}a.s(["UsersPage",()=>E],47836)}];

//# sourceMappingURL=components_dashboard_pages_users-page_tsx_c179a692._.js.map